function BundleLoader(){var a;this.element=document.createElement("div"),this.element.className="bundleloader",a=this.element.style,a.position="fixed",a.top="0",a.left="0",a.width="100%",a.height="100%",a.background="#000000",a.display="none",a.zIndex=1,a.overflow="hidden",this.titleElement=document.createElement("div"),this.titleElement.innerHTML="LOADING",a=this.titleElement.style,a.position="absolute",a.top="50%",a.width="100%",a.left="0",a.height="100px",a.color="#ffffff",a.textAlign="center",a.fontFamily="arial",a.fontSize="17px",a.marginTop="-32px",this.element.appendChild(this.titleElement),this.borderElement=document.createElement("div"),a=this.borderElement.style,a.width="33%",a.height="10px",a.border="2px solid white",a.borderRadius="5px",a.marginLeft="auto",a.marginRight="auto",a.top="50%",a.position="relative",a.padding="2px",this.element.appendChild(this.borderElement),this.progressElement=document.createElement("div"),a=this.progressElement.style,a.background="#ffffff",a.height="10px",a.width="0%",a.left="0",a.borderRadius="2px",a.position="relative",this.borderElement.appendChild(this.progressElement),this.animateInterval=null,this.loadRequest=null,this.completeProgress=null,this._visible=!0}var proto=BundleLoader.prototype;proto.waitForBodyAndAttach=function(){var a;return(a=this._parentElement?document.getElementById(this._parentElement):document.body)?void(this._visible&&!a.contains(this.element)&&a.appendChild(this.element)):void(this.loadRequest&&setTimeout(this.waitForBodyAndAttach.bind(this),10))},proto.showProgress=function(a,b){this.title=a,this.animateInterval&&clearInterval(this.animateInterval),this.animateInterval=null,this.element.style.display="block",this.titleElement.innerHTML=a,this.borderElement.style.display="block",null!=b&&void 0!=b?(b=Math.min(100,parseFloat(b)),this.progressElement.style.left="0",this.progressElement.style.width=b+"%"):(this.animateInterval=setInterval(this.onAnimateInterval.bind(this),30),this.progressElement.style.width="33%",this.progressElement.style.left="0%")},proto.showMessage=function(a){this.title=a,this.animateInterval&&clearInterval(this.animateInterval),this.animateInterval=null,this.element.style.display="block",this.titleElement.innerHTML=a,this.borderElement.style.display="none"},proto.onAnimateInterval=function(){var a=parseFloat(this.progressElement.style.left);a+=3,a>67&&(a=0),this.progressElement.style.left=a+"%"},proto.hide=function(){this.animateInterval&&clearInterval(this.animateInterval),this.animateInterval=null,this.element.style.display="none"},proto.load=function(a,b,c){if(b||(b="LOADING"),"string"==typeof a&&(a=[a]),this.completeProgress=c,this.completeProgress||(this.completeProgress=100),this.loadRequest)throw new Error("Already loading");this.urls=a,this.currentUrlIndex=0,this.loadNext(),this.showProgress(b),this.waitForBodyAndAttach()},proto.loadNext=function(){if(this.loadRequest)throw new Error("Already loading");return this.currentUrlIndex>=this.urls.length?(this.completeProgress&&this.completeProgress<100?this.showProgress(this.title,this.completeProgress):this.hide(),void(this.onload&&this.onload())):(this.loadRequest=new XMLHttpRequest,this.loadRequest.open("GET",this.urls[this.currentUrlIndex],!0),this.loadRequest.responseType="arraybuffer",this.loadRequest.onprogress=this.onLoadRequestProgress.bind(this),this.loadRequest.onload=this.onLoadRequestLoad.bind(this),this.loadRequest.onerror=this.onLoadRequestError.bind(this),void this.loadRequest.send())},proto.onLoadRequestProgress=function(a){if(a.total){var b=this.currentUrlIndex*this.completeProgress/this.urls.length,c=(this.currentUrlIndex+1)*this.completeProgress/this.urls.length;this.showProgress(this.title,b+(c-b)*a.loaded/a.total)}},proto.onLoadRequestLoad=function(){if(200!=this.loadRequest.status||!this.loadRequest.response.byteLength)return this.loadRequest=null,void this.showMessage("LOAD ERROR");var a=new Blob([this.loadRequest.response],{type:"text/javascript"});this.loadRequest;this.loadRequest=null;var b=document.createElement("script");b.src=window.URL.createObjectURL(a),b.onload=function(){setTimeout(function(){this.currentUrlIndex++,this.showProgress(this.title,this.completeProgress*this.currentUrlIndex/this.urls.length),this.loadNext()}.bind(this),100)}.bind(this),document.getElementsByTagName("head")[0].appendChild(b)},proto.onLoadRequestError=function(){this.loadRequest=null,this.showMessage("LOAD ERROR")},Object.defineProperty(proto,"visible",{get:function(){return this._visible},set:function(a){this._visible=a,this._visible&&document.body&&!document.body.contains(this.element)&&document.body.appendChild(this.element),!this._visible&&document.body&&document.body.contains(this.element)&&document.body.removeChild(this.element)}}),Object.defineProperty(proto,"parentElement",{get:function(){return this._parentElement},set:function(a){this._parentElement=a,this._parentElement?this.element.style.position="absolute":this.element.style.position="fixed",this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}),"undefined"!=typeof module&&(module.exports=BundleLoader);